import{E as j,aw as A,ax as N,r as T,c as H,ay as U,Q as q,az as G,w as J,aA as b,aB as y,aC as V,Y as O,aD as Q,a1 as D,b as f,aE as Z,a0 as i,a4 as o,aF as S,U as K,$ as n,a7 as p,j as h,a3 as d,Z as v,V as w,N as x,aG as z,m as L,aH as W,aI as B,aJ as X}from"./index-BWIOcCbp.js";import{T as k}from"./index-CcAfhpIB.js";import"./VTooltip-4QJAGpDJ.js";import"./VOverlay-ByscjEN9.js";import"./forwardRefs-CCYqePvv.js";import"./transition-DFWm4Wk0.js";const ee={ref:"rootRef",class:"datePicker"},te={class:"bg-surface d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},ae={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},se=["value"],oe={class:"d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},le={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},ne=["value"],me={__name:"EodashDatePicker",props:{hintText:{type:String,default:null},hideArrows:{type:Boolean,default:!1},hideInputField:{type:Boolean,default:!1},toggleCalendar:{type:Boolean,default:!1}},setup(l){K(a=>({f4706d8a:C.value}));const{lgAndDown:m}=j(),E=A("rootRef"),M=A("datePicker"),c=N((a,e)=>({get(){return a(),new Date(S.value).getTime()},set(t){e(),b.debug("Datepicker setting currentDate",S.value);const s=new Date(t);S.value=s.toISOString(),M.value?.move({month:s.getMonth()+1,year:s.getFullYear()})}})),$=T({input:"YYYY-MM-DD"}),F=a=>{const e=a.getFullYear(),t=a.getMonth()+1,s=a.getDate();return`${e}-${t<10?"0"+t:t}-${s<10?"0"+s:s}`},P=a=>{c.value=new Date(a.target?.value).getTime()},R=H(()=>F(new Date(c.value))),r=U([]),Y=q(G(),"selectedStac");J(Y,async(a,e)=>{if(a&&e?.id!==a.id){b.debug("Datepicker selected STAC change triggered"),r.splice(0,r.length);for(let t=0;t<y.length;t++){b.debug("Retrieving dates",y[t]),await y[t].fetchCollection();const s=[...new Set(y[t].getItems()?.reduce((u,_)=>{const I=Date.parse(_.datetime);return I&&u.push(new Date(I)),u},[]))];r.push({key:"id-"+t.toString()+Math.random().toString(16).slice(2),dot:{style:{backgroundColor:V[t%V.length]}},dates:s,content:{style:{color:"#000000","font-weight":"bold"}}})}}},{immediate:!0});function g(a){if(r.length){let e=a?1/0:-1/0;r.forEach(t=>{t?.dates&&t.dates.forEach(s=>{s instanceof Date&&(e=Math[a?"min":"max"](e,s.getTime()))})}),c.value=e===-1/0?Date.now():e===1/0?0:e}}const C=T("");return O(()=>{C.value=document.querySelector("eo-dash")?"translate3d(50px,-80px,0)":"translate3d(0px,-80px,0)"}),Q(E),(a,e)=>(n(),D("div",ee,[f(o(X),{ref:"datePicker",modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=t=>c.value=t),modelModifiers:{number:!0},attributes:r,masks:$.value,expanded:"",class:"bg-surface overflow-auto",style:{"background-color":"transparent","max-width":"100%"}},Z({_:2},[l.toggleCalendar?{name:"default",fn:i(({inputValue:t,inputEvents:s})=>[p("div",te,[l.hideArrows?d("v-if",!0):h((n(),v(w,{key:0,density:"compact",size:o(m)?"x-small":"large",variant:"text",onClick:e[0]||(e[0]=u=>g(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:i(()=>[f(x,{icon:[o(z)]},null,8,["icon"])]),_:1},8,["size"])),[[k,"Set date to oldest available dataset","bottom"]]),p("div",ae,[l.hideInputField?d("v-if",!0):(n(),D("input",L({key:0,value:t},W(s,!0),{class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}}),null,16,se))]),l.hideArrows?d("v-if",!0):h((n(),v(w,{key:1,density:"compact",size:o(m)?"x-small":"large",variant:"text",onClick:e[1]||(e[1]=u=>g(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:i(()=>[f(x,{icon:[o(B)]},null,8,["icon"])]),_:1},8,["size"])),[[k,"Set date to latest available dataset","bottom"]])])]),key:"0"}:{name:"footer",fn:i(()=>[p("div",oe,[l.hideArrows?d("v-if",!0):h((n(),v(w,{key:0,density:"compact",size:o(m)?"x-small":"large",variant:"text",onClick:e[2]||(e[2]=t=>g(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:i(()=>[f(x,{icon:[o(z)]},null,8,["icon"])]),_:1},8,["size"])),[[k,"Set date to oldest available dataset","bottom"]]),p("div",le,[l.hideInputField?d("v-if",!0):(n(),D("input",{key:0,value:R.value,onChange:P,class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},null,40,ne))]),l.hideArrows?d("v-if",!0):h((n(),v(w,{key:1,density:"compact",size:o(m)?"x-small":"large",variant:"text",onClick:e[3]||(e[3]=t=>g(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:i(()=>[f(x,{icon:[o(B)]},null,8,["icon"])]),_:1},8,["size"])),[[k,"Set date to latest available dataset","bottom"]])])]),key:"1"}]),1032,["modelValue","attributes","masks"])],512))}};export{me as default};
